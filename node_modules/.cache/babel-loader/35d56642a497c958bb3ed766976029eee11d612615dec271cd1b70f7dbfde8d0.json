{"ast":null,"code":"var _jsxFileName = \"C:\\\\WebDev\\\\mappy-boosted\\\\mappy2\\\\src\\\\context\\\\places\\\\PlacesProvider.tsx\",\n  _s = $RefreshSig$();\nimport { PlacesContext } from \"./PlacesContext\";\nimport { useReducer } from \"react\";\nimport { placesRedcuer } from \"./placesReducer\";\nimport { getUserLocation } from \"../../helpers/getUserLocation\";\nimport { useEffect } from \"react\";\nimport { SearchApi } from \"../../apis\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst INITIAL_STATE = {\n  isLoading: true,\n  userLocation: undefined\n};\nexport const PlacesProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [state, dispatch] = useReducer(placesRedcuer, INITIAL_STATE);\n  useEffect(() => {\n    getUserLocation().then(lnglat => dispatch({\n      type: \"setUserLocation\",\n      payload: lnglat\n    }));\n  }, []);\n  const searchPlacesByTerm = async query => {\n    if (query.length === 0) return []; // falta limpiar estate\n    if (!state.userLocation) throw new Error(\"No se ha podido obtener la ubicación del usuario\");\n    const resp = await SearchApi.get(`/${query}.json`, {\n      params: {\n        proximity: state.userLocation.join(\",\")\n      }\n    });\n    console.log(resp.data);\n    return resp.data;\n  };\n  return /*#__PURE__*/_jsxDEV(PlacesContext.Provider, {\n    value: {\n      ...state,\n      //methods\n      searchPlacesByTerm\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n};\n_s(PlacesProvider, \"zpn/kx5Q6O+5t2dWmjRtda+kHzA=\");\n_c = PlacesProvider;\nvar _c;\n$RefreshReg$(_c, \"PlacesProvider\");","map":{"version":3,"names":["PlacesContext","useReducer","placesRedcuer","getUserLocation","useEffect","SearchApi","jsxDEV","_jsxDEV","INITIAL_STATE","isLoading","userLocation","undefined","PlacesProvider","_ref","_s","children","state","dispatch","then","lnglat","type","payload","searchPlacesByTerm","query","length","Error","resp","get","params","proximity","join","console","log","data","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/WebDev/mappy-boosted/mappy2/src/context/places/PlacesProvider.tsx"],"sourcesContent":["import { PlacesContext } from \"./PlacesContext\";\r\nimport { useReducer } from \"react\";\r\nimport { placesRedcuer } from \"./placesReducer\";\r\nimport { getUserLocation } from \"../../helpers/getUserLocation\";\r\nimport { useEffect } from \"react\";\r\nimport { SearchApi } from \"../../apis\";\r\n\r\nexport interface PlaceState {\r\n    isLoading: boolean;\r\n    userLocation?: [number,number];\r\n}\r\nconst INITIAL_STATE: PlaceState = {\r\n    isLoading: true,\r\n    userLocation: undefined\r\n}\r\ninterface Props {\r\n    children: JSX.Element|JSX.Element[];\r\n}\r\n\r\nexport const PlacesProvider = ({children}:Props) => {\r\n    const [state, dispatch] = useReducer(placesRedcuer, INITIAL_STATE);\r\n\r\n    useEffect(() => {\r\n           getUserLocation()\r\n           .then((lnglat) => dispatch({type: \"setUserLocation\", payload: lnglat})) \r\n    }, []);\r\n\r\n    const searchPlacesByTerm = async (query:string) => {\r\n      if(query.length === 0) return []; // falta limpiar estate\r\n      if(!state.userLocation) throw new Error (\"No se ha podido obtener la ubicación del usuario\");\r\n      \r\n      const resp = await SearchApi.get(`/${query}.json`, {\r\n        params: {\r\n          proximity: state.userLocation.join(\",\"),\r\n        }\r\n      });\r\n      console.log(resp.data);\r\n      return resp.data;\r\n    }\r\n    \r\n\r\n  return (\r\n    <PlacesContext.Provider value={{\r\n      ...state,\r\n      //methods\r\n      searchPlacesByTerm\r\n    }}>\r\n        {children}\r\n\r\n    </PlacesContext.Provider>\r\n  )\r\n}\r\n"],"mappings":";;AAAA,SAASA,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,UAAU,QAAQ,OAAO;AAClC,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,eAAe,QAAQ,+BAA+B;AAC/D,SAASC,SAAS,QAAQ,OAAO;AACjC,SAASC,SAAS,QAAQ,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAMvC,MAAMC,aAAyB,GAAG;EAC9BC,SAAS,EAAE,IAAI;EACfC,YAAY,EAAEC;AAClB,CAAC;AAKD,OAAO,MAAMC,cAAc,GAAGC,IAAA,IAAsB;EAAAC,EAAA;EAAA,IAArB;IAACC;EAAc,CAAC,GAAAF,IAAA;EAC3C,MAAM,CAACG,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,UAAU,CAACC,aAAa,EAAEM,aAAa,CAAC;EAElEJ,SAAS,CAAC,MAAM;IACTD,eAAe,EAAE,CAChBe,IAAI,CAAEC,MAAM,IAAKF,QAAQ,CAAC;MAACG,IAAI,EAAE,iBAAiB;MAAEC,OAAO,EAAEF;IAAM,CAAC,CAAC,CAAC;EAC9E,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,kBAAkB,GAAG,MAAOC,KAAY,IAAK;IACjD,IAAGA,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC;IAClC,IAAG,CAACR,KAAK,CAACN,YAAY,EAAE,MAAM,IAAIe,KAAK,CAAE,kDAAkD,CAAC;IAE5F,MAAMC,IAAI,GAAG,MAAMrB,SAAS,CAACsB,GAAG,CAAE,IAAGJ,KAAM,OAAM,EAAE;MACjDK,MAAM,EAAE;QACNC,SAAS,EAAEb,KAAK,CAACN,YAAY,CAACoB,IAAI,CAAC,GAAG;MACxC;IACF,CAAC,CAAC;IACFC,OAAO,CAACC,GAAG,CAACN,IAAI,CAACO,IAAI,CAAC;IACtB,OAAOP,IAAI,CAACO,IAAI;EAClB,CAAC;EAGH,oBACE1B,OAAA,CAACP,aAAa,CAACkC,QAAQ;IAACC,KAAK,EAAE;MAC7B,GAAGnB,KAAK;MACR;MACAM;IACF,CAAE;IAAAP,QAAA,EACGA;EAAQ;IAAAqB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QAEY;AAE7B,CAAC;AAAAzB,EAAA,CAhCYF,cAAc;AAAA4B,EAAA,GAAd5B,cAAc;AAAA,IAAA4B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}